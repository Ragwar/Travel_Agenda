@using Microsoft.AspNetCore.Identity
@inject SignInManager<IdentityUser> SignInManager
@inject UserManager<IdentityUser> UserManager
@{
    var currentUser = await UserManager.GetUserAsync(User);
}
@if (SignInManager.IsSignedIn(User))
{
    <div class="text-center">
        <h1 class="display-4">Welcome to Travel Agenda</h1>
        <p>Lets help you schedule your next adventure!</p>
        <button id="startScheduleBtn" class="btn btn-primary">Start Schedule</button>
    </div>
}
else
{
    <div class="text-center">
        <h1 class="display-4">Welcome to Travel Agenda</h1>
        <p>Please login</p>
    </div>
}

<script>
    document.getElementById("startScheduleBtn").addEventListener("click", function() {
        fetch('/Home/CreateNewSchedule', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' }
        })
        .then(response => response.json())
        .then(data => {
            if (data.scheduleId) {
                window.location.href = `/Home/Index?scheduleId=${data.scheduleId}`;
            } else {
                alert("Failed to create schedule.");
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert("An error occurred while creating the schedule.");
        });
    });
</script>